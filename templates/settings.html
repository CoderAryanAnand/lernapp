<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings</title>
    <link rel="stylesheet" href="./static/output.css">
</head>
<body class="bg-zinc-200">
    <!-- TOP BAR -->
    <div class="bg-zinc-400 relative w-screen min-h-20" style="height:10vh">
        <div class="w-screen">
            <h2 class="mx-auto text-4xl font-extrabold px-4 pt-4 align-middle">Einstellungen</h2>
            <a href="/"><input type="image" class="absolute bottom-0 right-1" src="/static/img/KantiKoalaLogoVar2.png" style="height: 10vh"></a>
            <p class="absolute right-[10vh] top-2 text-right text-sm font-bold">KantiKoala, 2025</p>
        </div>
    </div>
    <!-- GENERAL SETTINGS -->
    <div class="sm:absolute top-[10vh] left-0 flex items-center flex-col">
        <!-- GENERAL -->
        <div class="bg-zinc-300 rounded-2xl p-1 m-3 w-[90vw] sm:w-[60vw] w-min-[300px]">
            <h3 class="text-center w-[90vw] sm:w-[60vw] sm:w-min-[300px] font-bold text-2xl">General</h3>
                <a id="chg_pw" href="/settings/change_password"><button>Change Password</button></a>
                
                <!-- Changed delete link to a secure form -->
                <form action="/settings/delete_account" method="post" onsubmit="return confirm('Are you sure you want to delete your account? This action cannot be undone.');" style="display: inline;">
                    <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
                    <button type="submit">Delete Account</button>
                </form>
        </div>
        <!-- AGENDA -->
        <div class="bg-zinc-300 rounded-2xl p-1 m-3 w-[90vw] sm:w-[60vw] sm:w-min-[300px]">
            <h3 class="font-bold text-2xl text-center w-[90vw] sm:w-[60vw] sm:w-min-[300px]">Agenda Settings</h3>
            <form method="post">
                <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
                <!-- General settings ... -->
                <input type="checkbox" id="saturday" name="learn_on_saturday" {% if learn_on_saturday %}checked{% endif %}>
                <label for="saturday">Include Saturday for learning</label><br><br>
                <input type="checkbox" id="sunday" name="learn_on_sunday" {% if learn_on_sunday %}checked{% endif %}>
                <label for="sunday">Include Sunday for learning</label><br><br>
                <label for="learning_time">Preferred daily learning start time:</label>
                <input type="time" id="learning_time" name="learning_time" value="{{ preferred_learning_time }}"><br><br>
                <input type="submit" value="Speichern">
            </form>
        </div>
    </div>
    

   
    <!-- Form to select default priority colors, to select if Saturday and/or Sunday can be used for learning (for the algorithm), and preferred learning time in a day -->
    <form method="post">
        <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
        
        <div class="sm:absolute right-0 top-[10vh]">
            <div class="flex items-center sm:items-end flex-col sm:justify-end">
                <div class="bg-zinc-300 rounded-2xl p-1 m-3 justify-center">
                    <h4 class=" text-center top-0 right-0 w-[90vw] sm:w-[35vw] min-w-[325px] text-2xl font-bold">Priorität Einstellungen</h4>
                    {% for prio in priority_settings %}
                        <div class="">
                            <div class="bg-zinc-400 rounded-2xl m-3 p-3 w-[85vw] sm:w-[35vw] sm:min-w-[300px]">
                                <fieldset>
                                    <legend class="font-bold text-xl text-center">Priorität {{ prio.priority_level }}</legend>
                                    <label class="font-bold">Farbe: <input class="bg-zinc-400"type="color" name="priority{{ prio.priority_level }}_color" value="{{ prio.color }}"></label><br>
                                    <label>Tage zum Lernen: <input type="number" name="priority{{ prio.priority_level }}_days" value="{{ prio.days_to_learn }}"></label><br>
                                    <label>Max. Stunden pro Tag: <input type="number" step="0.1" name="priority{{ prio.priority_level }}_max_hours_per_day" value="{{ prio.max_hours_per_day }}"></label><br>
                                    <label>Totale Stundenanzahl: <input type="number" step="0.1" name="priority{{ prio.priority_level }}_total_hours_to_learn" value="{{ prio.total_hours_to_learn }}"></label><br>
                                    <button type="submit" name="remove_priority" value="{{ prio.priority_level }}">Remove</button>
                                </fieldset>
                                <br>
                            </div>
                        </div>
                        
                    {% endfor %}
                    <div class="w-[35vw] w-min-[325px] flex justify-center"><button class="text-center font-bold px-2 mb-2 rounded-md bg-zinc-400 hover:italic hover:bg-zinc-200" type="submit" name="add_priority" value="1">Add Priority Level</button></div>
                    
                    <div class="w-[35vw] w-min-[325px] flex justify-center">
                        <input class="text-center font-bold px-2 rounded-md bg-zinc-400 hover:bg-zinc-200 hover:italic" type="submit" value="Speichern">
                    </div>
                    
                </div>
            </div>
        </div>
        
    </form>
</body>
</html>