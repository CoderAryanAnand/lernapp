<!--
    Responsive Navigation Bar Template
    - Uses Tailwind CSS for styling.
    - Shows a top bar on mobile and a sidebar on desktop.
    - Includes logo, navigation links, user info, and logout button.
    - Hamburger menu toggles mobile navigation.
-->

<!-- Navigation and layout CSS variables and responsive adjustments -->
<style>
  :root{
    --kk-nav-height: 64px;    /* mobile/top bar height */
    --kk-nav-width: 16rem;    /* desktop sidebar width (w-64) */
  }

  /* Default: mobile layout - fix top bar, add top padding so page content isn't hidden */
  nav.kk-nav { position: fixed; top: 0; left: 0; right: 0; z-index: 50; } /* let Tailwind bg classes control solid background */
  body { padding-top: var(--kk-nav-height); }

  /* Desktop: fix left sidebar and add left padding for content */
  @media (min-width: 768px) {
    nav.kk-nav { position: fixed; left: 0; top: 0; bottom: 0; width: var(--kk-nav-width); right: auto; z-index: 40; }
    body { padding-top: 0; padding-left: var(--kk-nav-width); }
  }

  /* keep mobile-menu dropdown positioned below the top bar */
  #mobile-menu { margin-top: 0; }
</style>

<!-- Main Navigation Container -->
<nav class="kk-nav bg-white dark:bg-zinc-800 border-b md:border-b-0 md:border-r border-zinc-200 dark:border-zinc-700">

    <!-- Mobile Top Bar (Visible on small screens, hidden on medium and up) -->
    <div class="md:hidden flex items-center justify-between p-4">
        <!-- Mobile Logo -->
        <a href="{{ url_for('main.index') }}" class="flex items-center space-x-2">
            <img class="h-10 w-10 dark:invert" src="{{ url_for('static', filename='img/KantiKoalaLogoVar2.png') }}" alt="KantiKoala Logo">
            <h2 class="text-2xl font-bold text-zinc-800 dark:text-white">KantiKoala</h2>
        </a>
        <!-- Hamburger Button for toggling mobile menu -->
        <button id="hamburger-button" class="p-2 rounded-md text-zinc-600 dark:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-700">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
        </button>
    </div>

    <!-- Mobile Menu (Initially hidden, toggled by hamburger button) -->
    <div id="mobile-menu" class="hidden md:hidden p-4 space-y-2 bg-white dark:bg-zinc-800 border-t border-zinc-200 dark:border-zinc-700 shadow-md z-50">
        <!-- Navigation links for mobile -->
        {% include '_nav_links.html' %}
    </div>

    <!-- Desktop Sidebar (Hidden on small screens, visible as a flex column on medium and up) -->
    <div class="hidden md:flex md:flex-col md:w-64 h-full">
        <!-- Logo and User Info -->
        <div class="p-4 border-b border-zinc-200 dark:border-zinc-700">
            <a href="{{ url_for('main.index') }}" class="flex items-center space-x-2">
                <img class="h-10 w-10 dark:invert" src="{{ url_for('static', filename='img/KantiKoalaLogoVar2.png') }}" alt="KantiKoala Logo">
                <h2 class="text-2xl font-bold text-zinc-800 dark:text-white">KantiKoala</h2>
            </a>
            {% if session.username %}
            <!-- Show username if logged in -->
            <p class="mt-2 text-sm text-zinc-600 dark:text-zinc-400">Willkommen, <span class="font-semibold">{{ session.username }}</span>!</p>
            {% endif %}
        </div>

        <!-- Navigation Links for desktop -->
        <div class="flex-grow p-4 space-y-2 overflow-auto">
            {% include '_nav_links.html' %}
        </div>

        <!-- Logout Button (only if logged in) -->
        {% if session.username %}
        <div class="p-4 border-t border-zinc-200 dark:border-zinc-700">
            <a href="{{ url_for('auth.logout') }}" class="flex items-center w-full px-4 py-2 text-red-600 dark:text-red-500 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/30">
                Logout
            </a>
        </div>
        {% endif %}
    </div>
</nav>

<!-- Script for toggling the mobile hamburger menu -->
<script>
    document.getElementById('hamburger-button').addEventListener('click', function() {
        var menu = document.getElementById('mobile-menu');
        menu.classList.toggle('hidden');
    });
</script>